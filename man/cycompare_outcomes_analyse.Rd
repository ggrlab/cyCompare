% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cycompare_outcomes_analyse.R
\name{cycompare_outcomes_analyse}
\alias{cycompare_outcomes_analyse}
\title{Core Analysis of Flow Cytometry Data Across Devices with outcomes}
\usage{
cycompare_outcomes_analyse(
  flowframes,
  df,
  ff_columns_relevant,
  dfcol_grouping_supersamples = c("Study"),
  dfcol_grouping_samples = "Device",
  dfcol_train_validation_other = "tvt",
  dfcol_outcomes = c("outcome_1", "outcome_2"),
  outcome_models = list(glmnet = glmnet::cv.glmnet),
  outdir_base = tempdir(),
  transformList = function(x) asinh(x/1000),
  gatingsets,
  gatename_primary,
  n_events_postgate = 10000,
  marker_to_gate,
  device_colors = function(n) {
     RColorBrewer::brewer.pal(n, "Dark2")
 },
  clustering_n_subsampling = 1,
  clustering_n_subsampled_cells = 10000,
  clustering_subsampling_seed_first = 42,
  kwargs_flowsom = list(nClus = 5, scale = FALSE, xdim = 3, ydim = 3, seed = 3711283),
  kwargs_modelling = list(hparam_n_evaluations = 3, seed = 42, learners_classification =
    list(mlr3::lrn("classif.ranger", predict_type = "prob", predict_sets = c("train",
    "test"), max.depth = paradox::to_tune(2, 20), num.trees = paradox::to_tune(c(500,
    1000, 1500, 2000)), importance = "impurity")), loss_measure =
    mlr3::msr("classif.logloss")),
  dv_class_positive = c(outcome_1 = "A", outcome_2 = 5.1)
)
}
\arguments{
\item{flowframes}{A named list of \code{flowFrame} objects containing flow cytometry data.}

\item{df}{A \code{data.table} with metadata. Must contain columns specified in \verb{dfcol_*} parameters and \code{File} as unique column linking to \code{names(flowframes)}.}

\item{ff_columns_relevant}{Character vector of markers to use for analysis and clustering.}

\item{dfcol_grouping_supersamples}{Metadata column used to define supersample groups (e.g., "Study").}

\item{dfcol_grouping_samples}{Metadata column used to group samples (e.g., "Device").}

\item{dfcol_train_validation_other}{Column defining sample roles ("train", "test", etc.).}

\item{dfcol_outcomes}{Character vector of column names containing outcome variables.}

\item{outcome_models}{Named list of modeling functions, defaulting to \code{cv.glmnet}.}

\item{outdir_base}{Base directory for saving intermediate results (default: \code{tempdir()}).}

\item{transformList}{A transformation function or a \code{flowCore::transformList} object (default: \code{asinh(x / 1e3)}).}

\item{gatingsets}{A named list of gating sets, one per dataset.}

\item{gatename_primary}{Character string indicating the population used for downstream analysis.}

\item{n_events_postgate}{Maximum number of events per sample to retain after gating.}

\item{marker_to_gate}{Named vector mapping marker names to gate names.}

\item{device_colors}{Either a named vector or a function that generates colors for each device.}

\item{clustering_n_subsampling}{Number of repeated subsamplings for FlowSOM (default: 1).}

\item{clustering_n_subsampled_cells}{Number of cells per sample for FlowSOM (default: 10,000).}

\item{clustering_subsampling_seed_first}{Seed for the first subsampling (default: 42).}

\item{kwargs_flowsom}{Named list of additional FlowSOM parameters (e.g. \code{nClus}, \code{scale}, \code{xdim}, \code{ydim}, \code{seed}).}

\item{kwargs_modelling}{Named list of model training parameters (e.g., learners, tuning, seed).}
}
\value{
A named list with three main components:
\describe{
\item{prepared_data}{List with transformed flowFrames, counts, and device colors.}
\item{clustering}{List with FlowSOM models trained on training data and applied to all samples.}
\item{models}{List with outcome models trained and applied to clustering results.}
}
}
\description{
This function performs preprocessing, transformation, FlowSOM clustering, and predictive modeling
on flow cytometry data to compare devices and generate outcome-based insights.
It returns intermediate structured data ready for downstream plotting or reporting.
}
