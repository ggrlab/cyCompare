% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fun_grouped.R
\name{fun_grouped}
\alias{fun_grouped}
\title{Apply a Function to Grouped Flow Cytometry Data}
\usage{
fun_grouped(
  data,
  make_flowset = TRUE,
  fun = flowsom_repeatsubsampling,
  df,
  dfcol_grouping_supersamples,
  dfcol_grouping_samples,
  dfcol_train_validation_other,
  dfcol_othergroups = NULL,
  outdir_base = NULL,
  verbose = FALSE,
  return_results = TRUE,
  subset_fun = function(data, elements) {
     data[elements]
 },
  ...
)
}
\arguments{
\item{data}{The data which should be subset. E.g.
\itemize{
\item A named list of flowFrames, indexed by the "File" column of df.
}}

\item{make_flowset}{Logical; if TRUE, convert subset to a flowSet before applying the function.}

\item{fun}{Function to apply on each group. Default: \code{flowsom_repeatsubsampling}.
The function should accept a flowSet and an output directory as first two arguments.}

\item{df}{Data frame containing all following \code{dfcol_XXX} and \code{File} column.}

\item{dfcol_grouping_supersamples}{Character; column name(s) for supersample grouping.}

\item{dfcol_grouping_samples}{Character; column name(s) for sample grouping.}

\item{dfcol_train_validation_other}{Character; column name to distinguish training/validation/other.}

\item{dfcol_othergroups}{Character vector (optional); other metadata columns for grouping.}

\item{outdir_base}{Character (optional); base directory for writing outputs. The output directory for each group will be
created by combining \code{outdir_base} with the grouping names. E.g.
\code{outdir_base/columnA.valueA___columnB.valueB}.}

\item{verbose}{Logical; print progress messages.}

\item{...}{Additional arguments passed to \code{fun}.}
}
\value{
A list with two elements:
\describe{
\item{results}{List of outputs returned by \code{fun} for each group.}
\item{groups}{Data frame of the grouping combinations used.}
}
}
\description{
This function applies a specified analysis function (e.g., FlowSOM training)
to subsets of flow cytometry data defined by unique combinations of df columns.
Each grouping results in a separate function call, which can be useful
for training models per sample, supersample, or condition.
}
