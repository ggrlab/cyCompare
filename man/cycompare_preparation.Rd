% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cycompare_preparation.R
\name{cycompare_preparation}
\alias{cycompare_preparation}
\title{Prepare Gated FlowFrames and Metadata for Cross-Device Comparison}
\usage{
cycompare_preparation(
  flowframes,
  df,
  ff_columns_relevant,
  device_colors = function(n) {
     RColorBrewer::brewer.pal(n, "Dark2")
 },
  gatingsets,
  gatename_primary,
  n_events_postgate = 10000,
  seed = 42,
  transformlist = NULL
)
}
\arguments{
\item{flowframes}{A named list of \code{flowFrame} objects. Names must match sample identifiers in \code{df}.}

\item{df}{A data.frame containing metadata for each sample, including a "Device" column.}

\item{ff_columns_relevant}{A character vector of column names to retain after gating (e.g., marker channels).}

\item{device_colors}{Either a named character vector mapping device names to colors, or a function \code{f(n)} returning \code{n} colors.
Defaults to using \code{RColorBrewer::brewer.pal(n, "Dark2")}.}

\item{gatingsets}{A named list of \code{GatingSet} objects used for gating, one per sample.}

\item{gatename_primary}{The name of the primary gate used to subset events (e.g., "Live").}

\item{n_events_postgate}{Exact number of events to retain per sample after gating. Might upsample cells. Default is 10,000. See \code{cytoBench::subsample_ff}.}

\item{seed}{Random seed for reproducibility when downsampling. Default is 42.}
}
\value{
A list with the following elements:
\describe{
\item{gated_ff}{A list of gated and downsampled \code{flowFrame} objects, keeping only relevant columns.}
\item{counts_joint}{A data.table with per-sample gated cell counts merged with metadata.}
\item{device_colors}{Named vector of device colors used, auto-assigned if a function was provided.}
}
}
\description{
This function applies a primary gating step to flow cytometry data,
assigns colors to devices, and prepares both gated events and metadata
for downstream analyses such as visualization or normalization.
}
